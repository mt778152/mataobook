"use strict";define(["jquery","temp","swiper","lazyload","text!template/index.html","text!template/bolck_list.html","text!template/recommend_list.html","text!template/dl-list.html"],function(n,l,t,a,e,o,c,s){var i=0;function d(t,a){var e=5*t,o=5*t+5,i=a.slice(e,o);return i.map(function(t,a){t.count=a+1}),i}n(".header .tap>span").on("click",function(){i=n(this).index(),n(".header span").eq(i).addClass("active").siblings().removeClass("active"),n(".content").css({transform:"translateX(-"+100*i+"%)"})}),n.ajax({url:"/api/index",dataType:"json",success:function(i){l(e,i.items[0].data,".book-city-cont"),new t(".banner",{loop:!0,autoplay:{delay:1e3}}),l(o,i.items[1].data.data,".week-hot-cont"),i.items[5].data.data.map(function(t){t.title=t.data.title,t.cover=t.data.cover,t.fiction_id=t.data.fiction_id}),l(o,i.items[5].data.data,".time-free-cont");l(c,d(0,i.items[2].data.data),".recommend-cont"),n(".change-btn").on("click",function(){var t=1*n(this).data("id"),a=n(this).attr("data"),e=i.items[a];console.log(e.data.count),t++,t%=e.data.count/5;var o=2==a?c:s;n(this).data("id",t),l(o,d(t,e.data.data),"."+n(this).prev().attr("class")),n("img.lazy").lazyload({effect:"fadeIn"})});l(s,d(0,i.items[3].data.data),".gril-cont");l(s,d(0,i.items[4].data.data),".boy-cont"),l(n(".text").html(),i.items[6],".sift-cont"),m(".book-city"),n("img.lazy").lazyload({effect:"fadeIn",container:n(".book-city")})}}),n.ajax({url:"/api/bookself",dataType:"json",success:function(t){console.log(t),l(o,t.items,".book-self-cont>div"),n(".book-self-btn").on("click",function(){n(this).toggleClass("active"),n(this).hasClass("active")?l(o,t.items,".book-self-cont>div"):l(s,t.items,".book-self-cont>div"),n("img.lazy").lazyload({effect:"fadeIn",container:n(".book-self")})}),n("img.lazy").lazyload({effect:"fadeIn",container:n(".book-self")})}});var f=0;function m(o){if(3<=f)return n(".loading").html("暂无数据"),!1;n(o).on("scroll",function(){var t,a=n(o).height(),e=n(this).children().height()-a;n(this).scrollTop()+40>=e&&(n(this).off("scroll"),t=++f,n.ajax({url:"/api/loadmore",data:{pagenum:t,limit:20},dataType:"json",success:function(t){l(s,t.items,".load-cont-list",1),console.log(t),m(".book-city"),n("img.lazy").lazyload({effect:"fadeIn",container:n(".book-city")})}}))})}});